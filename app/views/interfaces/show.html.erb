<div class="main_title blue_link">
  <%= @interface.class.to_s.match(/DNA/i) ? "DNA" : "RNA" %> Interface of SCOP domain, <%= link_to @interface.domain.sid, scop_path(@interface.domain) %>
</div>

<table id="interface_table" class="bipa">
  <tr>
    <th colspan=3>Interface Features</th>
    <th colspan=9>Interface Diagram</th>
  </tr>
  <tr>
    <td colspan=2 class="title">ASA</td>
    <td class="cell_number"><%=h "%.2f" % @interface[:asa] %> &Aring;</td>
    <td colspan=9 rowspan=10>Diagram</td>
  </tr>
  <tr>
    <td colspan=2 class="title">% of ASA</td>
    <td class="cell_number"><%=h "%.2f" % @interface[:asa] %></td>
  </tr>
  <tr>
    <td colspan=2 class="title">Polarity</td>
    <td class="cell_number"><%=h "%.2f" % @interface[:polarity] %></td>
  </tr>
  <tr>
    <td colspan=2 class="title">No. of Residues</td>
    <td class="cell_number"><%=h @interface[:residues_count] %></td>
  </tr>
  <tr>
    <td colspan=2 class="title">No. of Atoms</td>
    <td class="cell_number"><%=h @interface[:atoms_count] %></td>
  </tr>
  <tr>
    <td colspan=2 class="title">No. of Hydrogen Bond</td>
    <td class="cell_number"><%=h @interface[:hbonds_count] %></td>
  </tr>
  <tr>
    <td colspan=2 class="title">No. of Water-mediated Hydrogen Bond</td>
    <td class="cell_number"><%=h @interface[:whbonds_count] %></td>
  </tr>
  <tr>
    <td colspan=2 class="title">No. of van der Waals Contact</td>
    <td class="cell_number"><%=h @interface[:vdw_contacts_count] %></td>
  </tr>
  <tr>
    <td class="title" rowspan=2>SSE Composition</td>
    <td colspan=2 align="center">
      <%= image_tag @interface.sse_percentage_google_chart_url %>
    </td>
  </tr>
  <tr>
    <td colspan=2 align="center">
      <%= image_tag @interface.sse_propensity_google_chart_url %>
    </td>
  </tr>
  <tr>
    <td class="title" rowspan=2>Residue Composition</td>
    <td colspan=11 align="center">
      <%= image_tag @interface.residue_percentage_google_chart_url %>
    </td>
  </tr>
  <tr>
    <td colspan=11 align="center">
      <%= image_tag @interface.residue_propensity_google_chart_url %>
    </td>
  </tr>
  <tr>
    <td colspan=12 align="center" class="title">
      Similar Interfaces in Shape [<%= link_to "?", "#similar_interfaces_box", :id => "similar_interfaces_box_link" %>]<br />
      <div id="similar_interfaces_box">
        Similarities among nucleic acid-binding interfaces were measured using Ultrafast Shape Recognition (USR) method. Please see <a href="http://www.ncbi.nlm.nih.gov/pubmed/17342716">Ballester and Richard, 2007</a> for details.
      </div>
    </td>
  </tr>
  <tr>
    <th class="title">USR Score</th>
    <th class="title">Interface Type</th>
    <th class="title" colspan=2>SCOP domain sid</th>
    <th class="title">ASA</th>
    <th class="title">% of ASA</th>
    <th class="title">Polarity</th>
    <th class="title">No. of Atoms</th>
    <th class="title">No. of Residues</th>
    <th class="title">No. of Hydrogen Bonds</th>
    <th class="title">No. of Water-mediated Hydrogen Bonds</th>
    <th class="title">No. of van der Waals contacts</th>
  </tr>
  <% if @similar_interfaces.size > 0 %>
    <% @similar_interfaces.each do |int| %>
      <tr>
        <td class="cell_number"><%= "%.2f" % Interface.usr_score_between(@interface, int) %></td>
        <td class="cell_text"><%= link_to int.interface_type, interface_path(int) %></td>
        <td class="cell_text" colspan=2><%= link_to int.domain.sid, scop_path(int.domain.id) %></td>
        <td class="cell_number"><%= "%.2f" % int.asa %></td>
        <td class="cell_number"><%= "%.2f" % int.asa %></td>
        <td class="cell_number"><%= "%.2f" % int.polarity %></td>
        <td class="cell_number"><%= int.residues_count %></td>
        <td class="cell_number"><%= int.atoms_count %></td>
        <td class="cell_number"><%= int.hbonds_count %></td>
        <td class="cell_number"><%= int.whbonds_count %></td>
        <td class="cell_number"><%= int.vdw_contacts_count %></td>
      </tr>
    <% end %>
  <% else %>
    <tr>
      <td colspan=12 style="text-align:center;">
        N/A [<%= link_to "?", "#similar_interfaces_na_box", :id => "similar_interfaces_na_box_link" %>]<br />
        <div id="similar_interfaces_na_box">
          There is no interfaces having similar shapes in terms of Ultrafast Shape Recognition (USR) score (&gt; 0.5).
        </div>
      </td>
    </tr>
  <% end %>
</table>
