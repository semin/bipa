<% content_for :main_title do %>
  <div class="title">
    <%= @scop.hierarchy %>: <%= @scop.description %>
  </div>
<% end %>

<div id="tab_menu_container">
  <ul id="tab_menu">
    <li><a href="/scops/<%= @scop.id %>/hierarchy">Hierarchy</a></li>
    <li><a href="/scops/<%= @scop.id %>/summary" class="current">Summary</a></li>
    <li><a href="/scops/<%= @scop.id %>/propensities">Propensites</a></li>
    <li><a href="/scops/<%= @scop.id %>/frequencies">Frequencies</a></li>
    <li><a href="/scops/<%= @scop.id %>/alignments">Alignments</a></li>
    <li><a href="/scops/<%= @scop.id %>/interfaces">Interfaces</a></li>
  </ul>
</div>

<div id="below_tab_menu">

  <h4>&sect; Brief Statistics of Protein-Nucleic Acid Interfaces</h4>
  <table class="stats">
    <tr>
      <th style="border: 0px; background: white;"></th>
      <th style="border-left: 0px; width: 30%;">Protein-DNA</th>
      <th style="width: 30%;">Protein-RNA</th>
    </tr>
    <tr>
      <th style="border-top: 0px">Number of interfaces </th>
      <td><%= @scop.dna_interfaces(session[:redundancy], session[:resolution]).size %></td>
      <td><%= @scop.rna_interfaces(session[:redundancy], session[:resolution]).size %></td>
    </tr>
    <tr>
      <th>Average<br />ASA(&Aring;<sup>2</sup>)</th>
      <td>
        <% if @scop.dna_interfaces(session[:redundancy], session[:resolution]).size > 0 %>
          <%= "%.2f" % @scop.mean_dna_interface_asa(session[:redundancy], session[:resolution]) %>
          (<%= "%.2f" % @scop.stddev_dna_interface_asa(session[:redundancy], session[:resolution]) %>)
        <% else %>
          N/A
        <% end %>
      </td>
      <td>
        <% if @scop.rna_interfaces(session[:redundancy], session[:resolution]).size > 0 %>
          <%= "%.2f" % @scop.mean_rna_interface_asa(session[:redundancy], session[:resolution]) %>
          (<%= "%.2f" % @scop.stddev_rna_interface_asa(session[:redundancy], session[:resolution]) %>)
        <% else %>
          N/A
        <% end %>
      </td>
    </tr>
    <tr>
      <th>Average<br />Hydrogen bonds <br /> (per 100&Aring;<sup>2</sup>)</th>
      <td>
        <% if @scop.dna_interfaces(session[:redundancy], session[:resolution]).size > 0 %>
          <%= "%.2f" % @scop.mean_dna_interface_hbonds(session[:redundancy], session[:resolution]) %> 
          (<%= "%.2f" % @scop.stddev_dna_interface_hbonds(session[:redundancy], session[:resolution]) %>)
        <% else %>
          N/A
        <% end %>
      </td>
      <td>
        <% if @scop.rna_interfaces(session[:redundancy], session[:resolution]).size > 0 %>
          <%= "%.2f" % @scop.mean_rna_interface_hbonds(session[:redundancy], session[:resolution]) %> 
          (<%= "%.2f" % @scop.stddev_rna_interface_hbonds(session[:redundancy], session[:resolution]) %>)
        <% else %>
          N/A
        <% end %>
      </td>
    </tr>
    <tr>
      <th>Average<br />Water-mediated hydrogen bonds <br />(per 100&Aring;<sup>2</sup>)</th>
      <td>
        <% if @scop.dna_interfaces(session[:redundancy], session[:resolution]).size > 0 %>
          <%= "%.2f" % @scop.mean_dna_interface_whbonds(session[:redundancy], session[:resolution]) %> 
          (<%= "%.2f" % @scop.stddev_dna_interface_whbonds(session[:redundancy], session[:resolution]) %>)
        <% else %>
          N/A
        <% end %>
      </td>
      <td>
        <% if @scop.rna_interfaces(session[:redundancy], session[:resolution]).size > 0 %>
          <%= "%.2f" % @scop.mean_rna_interface_whbonds(session[:redundancy], session[:resolution]) %> 
          (<%= "%.2f" % @scop.stddev_rna_interface_whbonds(session[:redundancy], session[:resolution]) %>)
        <% else %>
          N/A
        <% end %>
      </td>
    </tr>
    <tr>
      <th>Average<br />van der Waals contacts<br />(per 100&Aring;<sup>2</sup>)</th>
      <td>
        <% if @scop.dna_interfaces(session[:redundancy], session[:resolution]).size > 0 %>
          <%= "%.2f" % @scop.mean_dna_interface_contacts(session[:redundancy], session[:resolution]) %> 
          (<%= "%.2f" % @scop.stddev_dna_interface_contacts(session[:redundancy], session[:resolution]) %>)
        <% else %>
          N/A
        <% end %>
      </td>
      <td>
        <% if @scop.rna_interfaces(session[:redundancy], session[:resolution]).size > 0 %>
          <%= "%.2f" % @scop.mean_rna_interface_contacts(session[:redundancy], session[:resolution]) %> 
          (<%= "%.2f" % @scop.stddev_rna_interface_contacts(session[:redundancy], session[:resolution]) %>)
        <% else %>
          N/A
        <% end %>
      </td>
    </tr>
    <tr>
      <th>Average<br />Polarity</th>
      <td>
        <% if @scop.dna_interfaces(session[:redundancy], session[:resolution]).size > 0 %>
          <%= "%.2f" % @scop.mean_dna_interface_polarity(session[:redundancy], session[:resolution]) %> 
          (<%= "%.2f" % @scop.stddev_dna_interface_polarity(session[:redundancy], session[:resolution]) %>)
        <% else %>
          N/A
        <% end %>
      </td>
      <td>
        <% if @scop.rna_interfaces(session[:redundancy], session[:resolution]).size > 0 %>
          <%= "%.2f" % @scop.mean_rna_interface_polarity(session[:redundancy], session[:resolution]) %> 
          (<%= "%.2f" % @scop.stddev_rna_interface_polarity(session[:redundancy], session[:resolution]) %>)
        <% else %>
          N/A
        <% end %>
      </td>
    </tr>
  </table>

  <small>* number in a bracket: standard deviation</small>
</div>
